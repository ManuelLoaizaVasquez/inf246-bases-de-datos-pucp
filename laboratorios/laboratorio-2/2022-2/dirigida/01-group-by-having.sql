-- 1. Uso de GROUP BY & HAVING
-- a. Conocer el promedio de ejemplares disponibles por biblioteca.

SELECT
    b.nombre_biblio,
    AVG(lxb.total_ejemplar) AS promedio_ejemplares
FROM
    libro_biblioteca lxb,
    biblioteca       b
WHERE
    lxb.cod_biblio = b.cod_biblio
GROUP BY
    b.nombre_biblio;

-- b. Obtener los alumnos que solicitaron mas de dos libros.
SELECT
    l.cod_alumno AS codigo_alumno,
    count(l.cod_libro) numero_libros_prestados
FROM
    libro_prestado l
GROUP BY
    l.cod_alumno
HAVING
    count(l.cod_libro) > 2;
    
    
insert into LIBRO_PRESTADO (COD_BIBLIO, COD_LIBRO, COD_ALUMNO, FECHA_SOLICITUD,    FECHA_ENTREGA, NRO_DIAS_PRESTADO) 
values ('B0001', 'L0001', 10000001, '6/05/2022', '11/05/2022', 5);
insert into LIBRO_PRESTADO (COD_BIBLIO, COD_LIBRO, COD_ALUMNO, FECHA_SOLICITUD,    FECHA_ENTREGA, NRO_DIAS_PRESTADO) 
values ('B0001', 'L0002', 10000001, '6/05/2022', '10/05/2022', 10);

insert into LIBRO_PRESTADO (COD_BIBLIO, COD_LIBRO, COD_ALUMNO, FECHA_SOLICITUD,    FECHA_ENTREGA, NRO_DIAS_PRESTADO) 
values ('B0001', 'L0009', 10000002, '16/06/2022', null, 5);
insert into LIBRO_PRESTADO (COD_BIBLIO, COD_LIBRO, COD_ALUMNO, FECHA_SOLICITUD,    FECHA_ENTREGA, NRO_DIAS_PRESTADO) 
values ('B0002', 'L0001', 10000002, '6/04/2022', '10/05/2022', 5);
insert into LIBRO_PRESTADO (COD_BIBLIO, COD_LIBRO, COD_ALUMNO, FECHA_SOLICITUD,    FECHA_ENTREGA, NRO_DIAS_PRESTADO) 
values ('B0002', 'L0003', 10000002, '26/04/2022', '01/05/2022', 5);

insert into LIBRO_PRESTADO (COD_BIBLIO, COD_LIBRO, COD_ALUMNO, FECHA_SOLICITUD,    FECHA_ENTREGA, NRO_DIAS_PRESTADO) 
values ('B0002', 'L0004', 10000003, '27/06/2022', '01/06/2022', 5);

insert into LIBRO_PRESTADO (COD_BIBLIO, COD_LIBRO, COD_ALUMNO, FECHA_SOLICITUD,    FECHA_ENTREGA, NRO_DIAS_PRESTADO) 
values ('B0005', 'L0001', 10000004, '01/09/2022', '10/09/2022', 5);
insert into LIBRO_PRESTADO (COD_BIBLIO, COD_LIBRO, COD_ALUMNO, FECHA_SOLICITUD,    FECHA_ENTREGA, NRO_DIAS_PRESTADO) 
values ('B0005', 'L0005', 10000004, '01/09/2022', '10/09/2022', 5);
insert into LIBRO_PRESTADO (COD_BIBLIO, COD_LIBRO, COD_ALUMNO, FECHA_SOLICITUD,    FECHA_ENTREGA, NRO_DIAS_PRESTADO) 
values ('B0005', 'L0006', 10000004, '01/09/2022', '10/09/2022', 5);
insert into LIBRO_PRESTADO (COD_BIBLIO, COD_LIBRO, COD_ALUMNO, FECHA_SOLICITUD,    FECHA_ENTREGA, NRO_DIAS_PRESTADO) 
values ('B0004', 'L0012', 10000004, '11/09/2022', '15/09/2022', 3);

insert into LIBRO_PRESTADO (COD_BIBLIO, COD_LIBRO, COD_ALUMNO, FECHA_SOLICITUD,    FECHA_ENTREGA, NRO_DIAS_PRESTADO) 
values ('B0003', 'L0007', 10000007, '19/09/2022', '20/09/2022', 3);
insert into LIBRO_PRESTADO (COD_BIBLIO, COD_LIBRO, COD_ALUMNO, FECHA_SOLICITUD,    FECHA_ENTREGA, NRO_DIAS_PRESTADO) 
values ('B0003', 'L0008', 10000007, '12/09/2022', '17/09/2022', 3);

insert into LIBRO_PRESTADO (COD_BIBLIO, COD_LIBRO, COD_ALUMNO, FECHA_SOLICITUD,    FECHA_ENTREGA, NRO_DIAS_PRESTADO) 
values ('B0004', 'L0002', 10000009, '21/08/2022', '30/08/2022', 3);
insert into LIBRO_PRESTADO (COD_BIBLIO, COD_LIBRO, COD_ALUMNO, FECHA_SOLICITUD,    FECHA_ENTREGA, NRO_DIAS_PRESTADO) 
values ('B0004', 'L0012', 10000009, '21/08/2022', '30/08/2022', 3);
insert into LIBRO_PRESTADO (COD_BIBLIO, COD_LIBRO, COD_ALUMNO, FECHA_SOLICITUD,    FECHA_ENTREGA, NRO_DIAS_PRESTADO) 
values ('B0005', 'L0006', 10000009, '01/05/2022', '10/05/2022', 5);
